Option 1:
Output a file for each context so no subthreads are needed.